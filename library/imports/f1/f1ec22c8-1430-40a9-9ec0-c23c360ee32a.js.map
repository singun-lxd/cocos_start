{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Player.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Player extends cc.Component {\r\n    // 主角跳跃高度\r\n    @property\r\n    jumpHeight: number = 0;\r\n\r\n    // 主角跳跃持续时间\r\n    @property\r\n    jumpDuration: number = 0;\r\n\r\n    // 最大移动速度\r\n    @property\r\n    maxMoveSpeed: number = 0;\r\n\r\n    // 加速度\r\n    @property\r\n    accel: number = 0;\r\n\r\n    private accLeft: boolean;\r\n    private accRight: boolean;\r\n    private jumpAction: cc.Action;\r\n    private xSpeed: number;\r\n\r\n    private setJumpAction(): cc.Action {\r\n        // 跳跃上升\r\n        let jumpUp: cc.ActionInterval = cc.moveBy(this.jumpDuration, cc.p(0, this.jumpHeight)).easing(cc.easeCubicActionOut());\r\n        // 下落\r\n        let jumpDown: cc.ActionInterval = cc.moveBy(this.jumpDuration, cc.p(0, -this.jumpHeight)).easing(cc.easeCubicActionIn());\r\n        // 不断重复\r\n        return cc.repeatForever(cc.sequence(jumpUp, jumpDown));\r\n    }\r\n\r\n    private setInputControl(): void {\r\n        var self: Player = this;\r\n        // 添加键盘事件监听\r\n        // 有按键按下时，判断是否是我们指定的方向控制键，并设置向对应方向加速\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function(event: cc.Event.EventCustom){\r\n            switch(event.keyCode) {\r\n                case cc.KEY.a:\r\n                    self.accLeft = true;\r\n                    break;\r\n                case cc.KEY.d:\r\n                    self.accRight = true;\r\n                    break;\r\n            }\r\n        });\r\n\r\n        // 松开按键时，停止向该方向的加速\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, function(event: cc.Event.EventCustom){\r\n            switch(event.keyCode) {\r\n                case cc.KEY.a:\r\n                    self.accLeft = false;\r\n                    break;\r\n                case cc.KEY.d:\r\n                    self.accRight = false;\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    protected onLoad(): void {\r\n        // 初始化跳跃动作\r\n        this.jumpAction = this.setJumpAction();\r\n        this.node.runAction(this.jumpAction);\r\n\r\n        // 加速度方向开关\r\n        this.accLeft = false;\r\n        this.accRight = false;\r\n        // 主角当前水平方向速度\r\n        this.xSpeed = 0;\r\n\r\n        // 初始化键盘输入监听\r\n        this.setInputControl();\r\n    }\r\n\r\n    protected update(dt: number): void {\r\n        // 根据当前加速度方向每帧更新速度\r\n        if (this.accLeft) {\r\n            this.xSpeed -= this.accel * dt;\r\n        } else if (this.accRight) {\r\n            this.xSpeed += this.accel * dt;\r\n        }\r\n        // 限制主角的速度不能超过最大值\r\n        if (Math.abs(this.xSpeed) > this.maxMoveSpeed) {\r\n            // if speed reach limit, use max speed with current direction\r\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\r\n        }\r\n\r\n        // 根据当前速度更新主角的位置\r\n        this.node.x += this.xSpeed * dt;\r\n    }\r\n}\r\n"]}